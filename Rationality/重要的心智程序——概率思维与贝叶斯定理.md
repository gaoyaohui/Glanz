# 重要的心智程序——概率思维与贝叶斯定理

1701年生的英国神学家、数学家托马斯·贝叶斯万万没想到，他在1963年所证明的一个关于贝叶斯定理的特例，发展至今，帮助人们思考在根据不确定性信息作出推理和决策这一领域拂去了重重迷雾，在统计学、金融、博弈论、乃至人工智能中发挥的无比重要的作用。这么重要的定理是不是特别难掌握以及高大上？没有没有，让我们来举个栗子了解一下。

假设你被诊断出患有非常罕见的疾病，这种病患的比例仅是人口的0.1％， 即每千人中有1人。你参加的检查这种疾病的检测能正确地找出99%的患者，将健康的人错误分类的几率只有1%。听到这里，是否你下意识觉得自己99%肯定是已经得了这个疾病了。不不不，贝叶斯开始拯救世界了。

## 拯救过程如下

首先我们定义两个事件，患病事件为H，诊断检测出阳性事件为E。在没有任何检查的情况下，患病概率P(H)=0.1%，在你确实患病的情况下，被检测出阳性的概率P(E|H)=99%  这里的E|H的意思就是你在确认的H的条件下E发生概率，我们称之为**条件概率**。
而你想要得到的答案其实是，在你被检测出阳性的情况下，自己确实患病的概率，P(H|E)。贝叶斯的定理告诉我们,P(H|E)≠P(E|H）。怎么理解这个意思？从逻辑上讲更好理解，所有小兔子都是可爱的，但这逻辑反过来就不对（所有可爱的都是小兔子）

P(H|E)如何算？贝叶斯公式正式出马：P(H|E)=P(E|H) *P(H)/P(E)

根据上面的已知的数字，我们还缺一个数值没有，就是P(E)。按照P(H)的类比，P(E)是所有检测阳性事件的综合，这里包含两个部分，所有确实患病，且检测出阳性的+没有患病，但是误检测为阳性的综合。确实患病，且检测出阳性的数学的表达是P(H)*P(E|H)。

重点来了，没有患病但是误诊的，千万不能漏。这里的数学表达是P(~H)*P(E|~H)，P(~H)=1-P(H)，它就是P(H)的备择假设，用白话讲就是要想到反面的情况。

最终，我们的答案带入公式，得出答案。

P(H|E)=P(E|H)xP(H)/[P(H)*P(E|H)+P(~H)*P(E|~H)]=99%x0.1%/(0.1%x99%+99.9%x1%)≈9%

我们图示化一下这个过程

![image-20200221192008713](https://tva1.sinaimg.cn/large/0082zybply1gc8rudvikgj31dy0nujyo.jpg)

到这里，你会发现概率你一开始理解的99%降低到9%，是不是突然觉得完全不一样了。你可能在问自己这是魔法吗?不，我的朋友们，这不是魔法，这只是概率应用数学的常识，正如丹尼尔•卡尼曼(Daniel Kahneman)在《思考，快与慢》中所描述的那样,人的大脑很难估计和计算概率,就像前面的示例所展示的一样,所以我们应该警惕直觉的惯性思考,后退一步,使用所能用的概率工具。

## 什么是忽略备择假设

我们继续沿用上面的例子，什么是忽略备择假设，就是忘记考虑P(~H)了，如果忽略了P(~H)，从公式上我们就可以看到直接后果就是分母变小，自然，最终的后验概率就会比真实的大很多，让你误以为自己真的病入膏肓，而做出错误的决策。备择假设也是双盲实验里对照组的重要逻辑依据之一。

## 什么是忽略基础概率

即使你完全不懂什么贝叶斯公式，这个病的P(H)=0.1%，假设有10万人参加检测，其中真正患病的人是有100人，100人中，检测为阳性的人为99人，10万减去100人，还有99900人是健康的，这部分人有1%是阳性，则是999人。那么所有患病且为阳性的是99/99+999，也能得出贝叶斯公式的结论。这就是基础概率的重要性。忽略基础概率，只谈特殊的条件概率，会让你盲目决策。

## 什么是贝叶斯直觉

这个著名定理背后的事实是，我们永远不可能完全确定这个世界，因为它是一个不断变化的存在，变化是现实的本质。然而，我们可以做的是，就像这个定理所表达的，随着我们获得越来越多的数据或证据，我们对现实的认识有了更新和提高。即使完全不懂贝叶斯定理，人类也在潜移默化中也会采用贝叶斯定理的方式进行思考。

我们举个例子：

![image-20200221203737243](https://tva1.sinaimg.cn/large/0082zybply1gc4ay5ml59j30m60kqaim.jpg)

图中有多少个箱子？特别地，那棵书后面是一个箱子？还是两个箱子？还是三个箱子？还是..你可能会觉得树后面肯定是一个箱子，但为什么不是两个呢？如下图：![image-20200221203809025](https://tva1.sinaimg.cn/large/0082zybply1gc4ayp65llj30g80k6djt.jpg)

很简单，你会说：要是真的有两个箱子那才怪了，怎么就那么巧这两个箱子刚刚好颜色相同，高度相同呢？用概率论的语言来说，你刚才的话就翻译为：猜测h不成立，因为P(D | h)太小（太巧合）了。我们的直觉是：巧合（小概率）事件不会发生。所以当一个猜测（假设）使得我们的观测结果成为小概率事件的时候，我们就说“才怪呢，哪能那么巧？！”

## Change log 

2020-2-21 Created

